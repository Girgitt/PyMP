#!/usr/bin/env python
# coding=utf-8

try:
    from setproctitle import setproctitle
    setproctitle  # workaround for pyflakes issue #13
except ImportError:
    setproctitle = None

import argparse
import logging
import sys
    
def main():
    # Setup logging
    log = logging.getLogger('pymp')
    formatter = logging.Formatter( '[%(asctime)s] [%(threadName)s] %(message)s')
    streamHandler = logging.StreamHandler(sys.stdout)
    streamHandler.setFormatter(formatter)
    streamHandler.setLevel(logging.DEBUG)
    log.addHandler(streamHandler)

    # Setup arg handling
    parser = argparse.ArgumentParser(description='Python MySQL Proxy')
    parser.add_argument('-v', '--verbose', action='count', default=0)

    args = parser.parse_args()

    if args.verbose > 2:
        log.setLevel(logging.DEBUG)
    elif args.verbose > 1:
        log.setLevel(logging.INFO)
    else:
        log.setLevel(logging.WARNING)

if __name__ == "__main__":
    if setproctitle:
        setproctitle('pymp')
    main()
